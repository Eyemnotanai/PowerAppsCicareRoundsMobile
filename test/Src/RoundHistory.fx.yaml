RoundHistory As screen:
    Fill: =RGBA(236, 236, 236, 1)
    OnVisible: |-
        =//write to audit log
        Patch(
            Audit_Log,
            Defaults(Audit_Log),
            {
                Title: User().Email & "Round History page",
                Activity: App.ActiveScreen.Name & "/Mobile app",
                LocationLong: Location.Longitude,
                LocationLat: Location.Latitude
            }
        );
        
        //Set time for session timeout
        Set(lastActivityTime, Now());
        //reset the timer for the UserLogOutCountDown
        Reset(tmCountDown);
        
        UpdateContext({flgCompSurv:false});      //show round history frame
        UpdateContext({flgAttendance:false});   //hide attendance frame
        UpdateContext({flgTeamReport:false});   //hide team report frame
        
        Refresh(Staff_Survey);          //RoundDate
        Refresh(Patient_Survey);
        
        
        Clear(colSurvList); //get survey history from both staff survey and patient survey
        Collect(
            colSurvList,
            ShowColumns(
                AddColumns(
                    Filter(Staff_Survey, RoundID>0),
                    "SurveyType",
                    "Staff",
                    "CreatedBy",
                    'Created By'.Email
                ),
                "ID",
                "Title",
                "Round_Unit",
                "SurveyType",
                "RoundID",
                "CreatedBy",
                "Created"
            )
        );
        Collect(
            colSurvList,
            ShowColumns(
                AddColumns(
                    Filter(Staff_Survey, RoundID=0),
                    "SurveyType",
                    "AdHoc",
                    "CreatedBy",
                    'Created By'.Email
                ),
                "ID",
                "Title",
                "Round_Unit",
                "SurveyType",
                "RoundID",
                "CreatedBy",
                "Created"
            )
        );
        /*
        Collect(//RoundStartDateTime
            colSurvList,
            ShowColumns(
                AddColumns(
                    Filter(Patient_Survey, RoundID>0),
                    "SurveyType",
                    "Patient",
                    "CreatedBy",
                    'Created By'.Email
                ),
                "ID",
                "Title",
                "Round_Unit",
                "SurveyType",
                "RoundID"
                "CreatedBy",
                "Created"
            )
        );
        
        Collect(//RoundStartDateTime
            colSurvList,
            ShowColumns(
                AddColumns(
                    Filter(Patient_Survey, RoundID>0),
                    "SurveyType",
                    "Patient",
                    "CreatedBy",
                    'Created By'.Email
                ),
                "ID",
                "Title",
                "RoundUnit",
                "SurveyType",
                "CreatedBy",
                "Created"
            )
        );
        Family
        AdHoc
        */
        ClearCollect(//Header of team survey report
            colMyTeamHD,
            {
                Rounder: "Name",
                RoundTime: "Scheduled Round Survey",
                SurveyTime: "Ad Hoc Survey"
            }
        );

    tmRoundHistory As timer:
        Duration: =varTimeDuration
        Height: =70
        OnTimerEnd: |-
            =If(
                DateDiff(
                    lastActivityTime,
                    Now(),
                    TimeUnit.Minutes
                ) > varSessionTime,
                //Launch("https://make.powerapps.com/",{}, LaunchTarget.Replace);
                //Launch("https://make.powerapps.com/");
                //Exit(true)
                Navigate(UserLogOutCountDown, ScreenTransition.None)
            )
        Visible: =varTimerFlag
        Width: =280
        X: =20
        Y: =1036
        ZIndex: =1

    tabRoundHistory As Tabs:
        Items: =colHorizontalMenu
        Y: =htmlHomeBack.Y+htmlHomeBack.Height
        ZIndex: =4

    htmlRoundHistory As htmlViewer:
        Height: =898
        HtmlText: |-
            ="<div style='border:1px gray;border-radius:10%;height:870px;width:100%;background-color:#FCFCFC'></div>"
        Width: =610
        X: =15
        Y: =rectRoundHistoryHeadBK.Y+rectRoundHistoryHeadBK.Height-28
        ZIndex: =6

    grpRoundHitoryHD As group:
        Height: =5
        Width: =5
        X: =60
        Y: =60
        ZIndex: =6

        imgRoundHistory As image:
            Height: =150
            Image: =abstractBackground
            ImagePosition: =ImagePosition.Fill
            Width: =640
            ZIndex: =2

        rectRoundHistoryHeadBK As rectangle:
            Fill: =RGBA(39, 116, 181, 0.65)
            Height: =150
            Width: =640
            ZIndex: =3

        lblRoundHistoryHead As label:
            Align: =Align.Center
            Color: =RGBA(255, 255, 255, 1)
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Bold
            Height: =150
            Size: =32
            Text: ="Rounds History"
            Width: =640
            ZIndex: =5

    galRoundHistoryTeam As gallery.galleryVertical:
        Height: =691
        Items: |-
            =/*
            ForAll(
                colMyDirectReports,
                {
                    RounderName: displayName,
                    Eamil: mail,
                    RoundDate: LookUp(
                        Filter(
                            SortByColumns(
                                Rounds_Calendar,
                                "EventDate",
                                SortOrder.Descending
                            ),
                            !IsBlank(SurveyDateTime)
                        ),
                        Attendees.Email = mail,
                        'Start Time'
                    ),
                    SurvDate: LookUp(
                        Filter(
                            SortByColumns(
                                Rounds_Calendar,
                                "EventDate",
                                SortOrder.Descending
                            ),
                            !IsBlank(SurveyDateTime)
                        ),
                        Attendees.Email = mail,
                        SurveyDateTime
                    )
                }
            )
            */
        Layout: =Layout.Vertical
        TemplateSize: =If(Self.Layout = Layout.Horizontal, Min(280, Self.Width - 60), Min(280, Self.Height - 60))
        Visible: =flgTeamReport
        Width: =570
        X: =35
        Y: =galRoundHistoryTeamHD.Y+galRoundHistoryTeamHD.Height
        ZIndex: =7

    "galRoundHistoryTeamHD As gallery.'BrowseLayout_Horizontal_TwoTextOneImageVariant_ver4.0'":
        Fill: =RGBA(0, 85, 135, 1)
        Height: =60
        Items: =colMyTeamHD
        TemplatePadding: =0
        TemplateSize: =138
        Visible: =flgTeamReport
        Width: =570
        X: =35
        Y: =rectRHTeamRptDateBG.Y+rectRHTeamRptDateBG.Height
        ZIndex: =12

        lblRHAdHocSurv As label:
            Align: =Align.Center
            BorderThickness: =1
            Color: =RGBA(255, 255, 255, 1)
            FontWeight: =FontWeight.Semibold
            Height: =60
            OnSelect: =Select(Parent)
            Size: =12
            Text: =ThisItem.SurveyTime
            Width: =225
            X: =lblRHRoundSurv.X+lblRHRoundSurv.Width
            ZIndex: =1

        lblRHRoundSurv As label:
            Align: =Align.Center
            BorderThickness: =1
            Color: =RGBA(255, 255, 255, 1)
            Fill: =RGBA(0, 85, 135, 1)
            FontWeight: =FontWeight.Semibold
            Height: =60
            OnSelect: =Select(Parent)
            Size: =12
            Text: =ThisItem.RoundTime
            Width: =170
            X: =lblRHRounderHD.X+lblRHRounderHD.Width
            ZIndex: =2

        lblRHRounderHD As label:
            Align: =Align.Center
            BorderThickness: =1
            Color: =RGBA(255, 255, 255, 1)
            Fill: =RGBA(0, 85, 135, 1)
            FontWeight: =FontWeight.Semibold
            Height: =60
            OnSelect: =Select(Parent)
            Size: =12
            Text: =ThisItem.Rounder
            Width: =170
            ZIndex: =3

    grpRHCompDate As group:
        Height: =5
        Width: =5
        X: =40
        Y: =60
        ZIndex: =13

        rectRHCompSurvDate As rectangle:
            Fill: =RGBA(218, 235, 254, 0.5)
            Height: =55
            Visible: |-
                =//flgCompSurv
                true
            Width: =590
            X: =20
            Y: =galRoundHistoryMenu.Y+galRoundHistoryMenu.Height+20
            ZIndex: =14

        dpRHCompEnd As datepicker:
            Height: =50
            IconBackground: =RGBA(39, 116, 174,1)
            OnChange: |-
                =//logging activites
                Patch(
                    Audit_Log,
                    Defaults(Audit_Log),
                    {
                        Title: User().Email & " Round History",
                        Activity: "Change end date time " & dpRHCompStart.SelectedDate,
                        LocationLong: Location.Longitude,
                        LocationLat: Location.Latitude
                    }
                );
                //refresh time for the timeout
                Set(lastActivityTime, Now());
            OnSelect: |-
                =//logging activites
                Patch(
                    Audit_Log,
                    Defaults(Audit_Log),
                    {
                        Title: User().Email & " Round History",
                        Activity: "Select end date time " & dpRHCompStart.SelectedDate,
                        LocationLong: Location.Longitude,
                        LocationLat: Location.Latitude
                    }
                );
                //refresh time for the timeout
                Set(lastActivityTime, Now());
            Size: =12
            Visible: |-
                =//flgCompSurv
                true
            Width: =165
            X: =lblRHCompEnd.X+lblRHCompEnd.Width+10
            Y: =galRoundHistoryMenu.Y+galRoundHistoryMenu.Height+15
            ZIndex: =15

        lblRHCompEnd As label:
            FontWeight: =FontWeight.Semibold
            Height: =50
            Size: =14
            Text: ="End Date"
            Visible: |-
                =//flgCompSurv
                true
            Width: =100
            X: =dpRHCompStart.X+dpRHCompStart.Width+20
            Y: =galRoundHistoryMenu.Y+galRoundHistoryMenu.Height+15
            ZIndex: =26

        dpRHCompStart As datepicker:
            DefaultDate: =DateAdd(Today(), -30)
            Height: =50
            IconBackground: =RGBA(39, 116, 174,1)
            OnChange: |-
                =//logging activites
                Patch(
                    Audit_Log,
                    Defaults(Audit_Log),
                    {
                        Title: User().Email & " Round History",
                        Activity: "Change start date time " & dpRHCompStart.SelectedDate,
                        LocationLong: Location.Longitude,
                        LocationLat: Location.Latitude
                    }
                );
                //refresh time for the timeout
                Set(lastActivityTime, Now());
            OnSelect: |-
                =//logging activites
                Patch(
                    Audit_Log,
                    Defaults(Audit_Log),
                    {
                        Title: User().Email & " Round History",
                        Activity: "Select start date time " & dpRHCompStart.SelectedDate,
                        LocationLong: Location.Longitude,
                        LocationLat: Location.Latitude
                    }
                );
                //refresh time for the timeout
                Set(lastActivityTime, Now());
            Size: =12
            Visible: |-
                =//flgCompSurv
                true
            Width: =160
            X: =lblRHCompStart.X+lblRHCompStart.Width+10
            Y: =galRoundHistoryMenu.Y+galRoundHistoryMenu.Height+15
            ZIndex: =28

        lblRHCompStart As label:
            FontWeight: =FontWeight.Semibold
            Height: =50
            PaddingLeft: =15
            Size: =14
            Text: ="Start Date"
            Visible: |-
                =//flgCompSurv
                true
            Width: =120
            X: =25
            Y: =galRoundHistoryMenu.Y+galRoundHistoryMenu.Height+15
            ZIndex: =32

    lblRHNotHistoryMsg As label:
        Align: =Align.Center
        Color: =RGBA(255, 0, 0, 1)
        FontWeight: =FontWeight.Bold
        Height: =122
        Size: =25
        Text: ="You don't have any round hitory"
        Visible: =If(CountRows(galRHCompSurvey.AllItems) >=1, false, true)
        Width: =560
        X: =42
        Y: =362
        ZIndex: =30

    "galRHCompSurvey As gallery.'BrowseLayout_Vertical_OneTextVariant_ver4.0'":
        Height: =745
        Items: |
            =SortByColumns(
                Filter(
                    Filter(
                        colSurvList,
                        dpRHCompStart.SelectedDate = Blank() Or Created >= dpRHCompStart.SelectedDate,
                        dpRHCompEnd.SelectedDate = Blank() Or Created <= DateAdd(//Add a day because the date compared with hours, minutes and seconds.
                            dpRHCompEnd.SelectedDate,
                            1
                        )
                    ),
                    Lower(CreatedBy) = Lower(User().Email)
                ),
                "Created",
                SortOrder.Descending
            )
        Layout: =Layout.Vertical
        TemplatePadding: =0
        TemplateSize: =150
        Visible: =flgCompSurv
        Y: =rectRHCompSurvDate.Y+rectRHCompSurvDate.Height
        ZIndex: =31

        Separator13 As rectangle:
            Height: =1
            OnSelect: =Select(Parent)
            Width: =Parent.TemplateWidth
            Y: =Parent.TemplateHeight - 1
            ZIndex: =1

        btnRHViewSurv As button:
            Height: =50
            OnSelect: |-
                =//Select(Parent)
                /*
                If(
                    ThisItem.SurveyType = "Staff",
                    Navigate(
                        StaffSurvDetail,
                        ScreenTransition.None,
                        {varStaffSurvViewID: ThisItem.ID}
                    ),
                    Navigate(
                        PatientSurvDetail,
                        ScreenTransition.None,
                        {varPatientSurvViewID: ThisItem.ID}
                    )
                );
                */
                //logging activites
                Patch(
                    Audit_Log,
                    Defaults(Audit_Log),
                    {
                        Title: User().Email & " Round History",
                        Activity: "View survey detail",
                        LocationLong: Location.Longitude,
                        LocationLat: Location.Latitude
                    }
                );
                //refresh time for the timeout
                Set(lastActivityTime, Now());
            RadiusBottomLeft: =30
            RadiusBottomRight: =30
            RadiusTopLeft: =30
            RadiusTopRight: =30
            Size: =18
            Text: ="View"
            Width: =120
            X: =492
            Y: =80
            ZIndex: =2

        btnRHEditSurv As button:
            Fill: =RGBA(139, 184, 232, 1)
            Height: =50
            OnSelect: |-
                =//Select(Parent)
                /*
                If(
                    ThisItem.SurveyType = "Staff",
                    Navigate(
                        StaffSurvDetail,
                        ScreenTransition.None,
                        {varStaffSurvViewID: ThisItem.ID}
                    ),
                    Navigate(
                        PatientSurvDetail,
                        ScreenTransition.None,
                        {varPatientSurvViewID: ThisItem.ID}
                    )
                )
                */
                /*
                //logging activites
                Patch(
                    Audit_Log,
                    Defaults(Audit_Log),
                    {
                        Title: User().Email & " Round History",
                        Activity: "Edit survey button clicked for " & ThisItem.RoundUnit & "|" & ThisItem.SurveyType,
                        LocationLong: Location.Longitude,
                        LocationLat: Location.Latitude
                    }
                );
                */
                
                //refresh time for the timeout
                Set(lastActivityTime, Now());
                /*
                If(
                    ThisItem.SurveyType = "Staff",
                    Navigate(
                        StaffSurveyForm,
                        ScreenTransition.None,
                        {
                            varMyreservationTitle: ThisItem.Title,
                            varSurvStatus: "edit"
                        }
                    ),//edit exist staff survey
                    If(
                        ThisItem.SurveyType = "Patient",
                        Navigate(
                            PatientSurveyForm,
                            BorderStyle.None,
                            {
                                varMyreservationTitle: ThisItem.Title,
                                varSurvStatus: "edit"
                            }
                        ),//edit exist patient survey
                        Navigate(
                            PatientSurveyForm,
                            BorderStyle.None,
                            {
                                varPatientSurv: "Family",
                                varMyreservationTitle: ThisItem.Title,
                                varSurvStatus: "edit"
                            }
                        )//edit exist patient survey for family
                    )
                );
                */
            RadiusBottomLeft: =30
            RadiusBottomRight: =30
            RadiusTopLeft: =30
            RadiusTopRight: =30
            Size: =18
            Text: ="Edit"
            Visible: |-
                =//If(ThisItem.Created >= Today()-1, true, false) //original code
                //If(ThisItem.Created >= Today(), true, false)
            Width: =120
            X: =492
            Y: =20
            ZIndex: =3

        lblRHCategory As label:
            OnSelect: =Select(Parent)
            Size: =16
            Text: =//ThisItem.SurveyType
            Width: =280
            X: =lblRHCateLabel.X+lblRHCateLabel.Width
            Y: =lblRHTitle.Y+lblRHTitle.Height
            ZIndex: =4

        lblRHCateLabel As label:
            FontWeight: =FontWeight.Semibold
            OnSelect: =Select(Parent)
            Size: =18
            Text: |-
                ="Category: "
            Width: =125
            X: =24
            Y: =lblRHTitle.Y+lblRHTitle.Height
            ZIndex: =5

        lblRHTitle As label:
            FontWeight: =FontWeight.Normal
            Height: =45
            OnSelect: =Select(Parent)
            PaddingBottom: =0
            Size: =16
            Text: =ThisItem.Title
            VerticalAlign: =VerticalAlign.Top
            Width: =450
            Wrap: =false
            X: =24
            Y: =60
            ZIndex: =6

        lblRHLocation As label:
            OnSelect: =Select(Parent)
            Size: =16
            Text: =ThisItem.Round_Unit
            Width: =300
            X: =lblRHLocationLabel.X+lblRHLocationLabel.Width
            Y: =10
            ZIndex: =7

        lblRHLocationLabel As label:
            FontWeight: =FontWeight.Semibold
            OnSelect: =Select(Parent)
            Size: =18
            Text: |-
                ="Location: "
            Width: =120
            X: =24
            Y: =10
            ZIndex: =8

    galRoundHistoryMenu As gallery.galleryHorizontal:
        Height: =40
        Items: |-
            =["Completed Survey", "Attendance", "Team Report"]
            //["Completed Survey", "Attendance"]
        TemplateFill: =If(ThisItem.IsSelected, RGBA(255, 199, 44, 1), RGBA(246, 244, 238, 1))
        TemplatePadding: =0
        TemplateSize: =180
        Width: =558
        X: =40
        Y: =htmlRoundHistory.Y+30
        ZIndex: =33

        btnMenuContent As button:
            BorderThickness: =1
            Color: =RGBA(39, 116, 174,1)
            Fill: |
                =//If(ThisItem.IsSelected, RGBA(255, 199, 44, 1), RGBA(246, 244, 238, 1))
                Color.Transparent
            HoverColor: =RGBA(39, 116, 174,1)
            HoverFill: =If(ThisItem.IsSelected, RGBA(255, 199, 44, 1), RGBA(246, 244, 238, 1))
            OnSelect: |
                =/*
                ["Completed Survey", "Attendance", "Team Report"]
                */
                If(
                    ThisItem.Value = "Completed Survey",            //"Upcoming", "Previous", "Activities","My Team"
                    UpdateContext({flgCompSurv: true});
                    UpdateContext({flgAttendance: false});
                    UpdateContext({flgTeamReport: false}),
                    If(
                        ThisItem.Value = "Attendance",
                        UpdateContext({flgCompSurv: false});
                        UpdateContext({flgAttendance: true});
                        UpdateContext({flgTeamReport: false}),
                        If(
                            ThisItem.Value = "Team Report",
                            UpdateContext({flgCompSurv: false});
                            UpdateContext({flgAttendance: false});
                            UpdateContext({flgTeamReport: true});
                        )
                        
                    )
                );
                //logging activites
                Patch(
                    Audit_Log,
                    Defaults(Audit_Log),
                    {
                        Title: User().Email & " Round History tab",
                        Activity: "Tab clicked " & ThisItem.Value,
                        LocationLong: Location.Longitude,
                        LocationLat: Location.Latitude
                    }
                );
                //refresh time for the timeout
                Set(lastActivityTime, Now());
            PressedColor: =RGBA(39, 116, 174,1)
            PressedFill: =If(ThisItem.IsSelected, RGBA(255, 199, 44, 1), RGBA(246, 244, 238, 1))
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =14
            Text: =ThisItem.Value
            Width: =180
            ZIndex: =1

    grpRHTeamRptDate As group:
        Height: =5
        Width: =5
        X: =80
        Y: =80
        ZIndex: =33

        rectRHTeamRptDateBG As rectangle:
            Fill: =RGBA(218, 235, 254, 0.5)
            Height: =55
            Visible: =flgTeamReport
            Width: =570
            X: =35
            Y: =galRoundHistoryMenu.Y+galRoundHistoryMenu.Height+20
            ZIndex: =8

        dpRHTREnd As datepicker:
            Height: =50
            IconBackground: =RGBA(39, 116, 174,1)
            Size: =12
            Visible: =flgTeamReport
            Width: =165
            X: =lblRHTREnd.X+lblRHTREnd.Width+10
            Y: =galRoundHistoryMenu.Y+galRoundHistoryMenu.Height+20
            ZIndex: =9

        lblRHTREnd As label:
            FontWeight: =FontWeight.Semibold
            Height: =50
            Size: =14
            Text: ="End Date"
            Visible: =flgTeamReport
            Width: =100
            X: =dpRHTRStart.X+dpRHTRStart.Width+10
            Y: =galRoundHistoryMenu.Y+galRoundHistoryMenu.Height+20
            ZIndex: =10

        dpRHTRStart As datepicker:
            DefaultDate: =DateAdd(Today(), -30)
            Height: =50
            IconBackground: =RGBA(39, 116, 174,1)
            Size: =12
            Visible: =flgTeamReport
            Width: =160
            X: =lblRHTRStart.X+lblRHTRStart.Width+10
            Y: =galRoundHistoryMenu.Y+galRoundHistoryMenu.Height+20
            ZIndex: =11

        lblRHTRStart As label:
            FontWeight: =FontWeight.Semibold
            Height: =50
            PaddingLeft: =15
            Size: =14
            Text: ="Start Date"
            Visible: =flgTeamReport
            Width: =115
            X: =35
            Y: =galRoundHistoryMenu.Y+galRoundHistoryMenu.Height+20
            ZIndex: =13

    Label5 As label:
        Height: =70
        Size: =21
        Text: =CountRows(colSurvList)
        Width: =560
        X: =54
        Y: =30
        ZIndex: =34

    grpRHAtendance As group:
        Height: =5
        Width: =5
        X: =60
        Y: =60
        ZIndex: =35

        rectRHAttBG As rectangle:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =745
            Visible: =flgAttendance
            Width: =rectRHCompSurvDate.Width
            X: =rectRHCompSurvDate.X
            Y: =rectRHCompSurvDate.Y+rectRHCompSurvDate.Height
            ZIndex: =16

        lblRHTotal As label:
            BorderThickness: =1
            Color: =RGBA(39, 116, 174,1)
            Fill: =RGBA(255, 184, 28, 1)
            FontWeight: =FontWeight.Bold
            Height: =73
            PaddingLeft: =15
            PaddingRight: =15
            Size: =18
            Text: |-
                =/*CountRows(
                    Filter(
                        colSurvInfo, 
                        And(
                            Created >= dateRHStart.SelectedDate,
                            Created <= dateRHEnd
                        )
                    )
                )
                */
                Value(lblRHStaff.Text) + Value(lblRHPatient.Text) + Value(lblRHFamily.Text)
            Visible: =flgAttendance
            Width: =325
            X: =269
            Y: =lblRHAdhoc.Y+lblRHAdhoc.Height+40
            ZIndex: =17

        lblRHTotalLabel As label:
            Align: =Align.Right
            Color: =RGBA(39, 116, 174,1)
            FontWeight: =FontWeight.Bold
            Height: =73
            Size: =21
            Text: |-
                ="Total:"
            Visible: =flgAttendance
            Width: =195
            X: =49
            Y: =lblRHAdhocLabel.Y+lblRHAdhocLabel.Height+40
            ZIndex: =18

        lblRHAdhoc As label:
            BorderThickness: =1
            Color: =RGBA(39, 116, 174,1)
            Height: =70
            PaddingLeft: =15
            Size: =18
            Text: |-
                =CountRows(
                    Filter(
                        RenameColumns(
                            Filter(
                                Filter(
                                    Filter(
                                        colSurvList,
                                        Lower(CreatedBy) = Lower(User().Email)
                                    ),
                                    SurveyType = "AdHoc"
                                ),
                                And(
                                    Created >= dpRHCompStart.SelectedDate,
                                    Created <= dpRHCompEnd
                                )
                            ),
                            "Created",
                            "SurvCreated"
                        ),
                        LookUp(
                            Rounds_Calendar,
                            DateDiff('Start Time', SurvCreated, TimeUnit.Days)=0,
                            true
                        )
                    )
                )
            Width: =323
            X: =269
            Y: =lblRHFamilyLabel.Y+lblRHFamilyLabel.Height+40
            ZIndex: =19

        lblRHAdhocLabel As label:
            Align: =Align.Right
            Color: =RGBA(39, 116, 174,1)
            FontWeight: =FontWeight.Bold
            Height: =70
            Size: =18
            Text: ="Ad Hoc Survey"
            Width: =195
            X: =49
            Y: =lblRHFamilyLabel.Y+lblRHFamilyLabel.Height+40
            ZIndex: =20

        lblRHFamily As label:
            BorderThickness: =1
            Color: =RGBA(39, 116, 174,1)
            Height: =73
            PaddingLeft: =15
            PaddingRight: =15
            Size: =18
            Text: |
                =CountRows(
                    Filter(
                        RenameColumns(
                            Filter(
                                Filter(
                                    Filter(
                                        colSurvList,
                                        Lower(CreatedBy) = Lower(User().Email)
                                    ),
                                    SurveyType = "Family"
                                ),
                                And(
                                    Created >= dpRHCompStart.SelectedDate,
                                    Created <= dpRHCompEnd
                                )
                            ),
                            "Created",
                            "SurvCreated"
                        ),
                        LookUp(
                            Rounds_Calendar,
                            DateDiff('Start Time', SurvCreated, TimeUnit.Days)=0,
                            true
                        )
                    )
                )
                /*CountRows(
                    Filter(
                        Filter(
                            Filter(
                                colSurvList,
                                Lower(CreatedBy)=Lower(User().Email)
                            ),
                            SurveyType = "Family"
                        ),
                        And(
                            Created >= dateRHStart.SelectedDate,
                            Created <= dateRHEnd
                        )
                    )
                )
                */
            Visible: =flgAttendance
            Width: =323
            X: =269
            Y: =lblRHPatientLabel.Y+lblRHPatientLabel.Height+40
            ZIndex: =21

        lblRHFamilyLabel As label:
            Align: =Align.Right
            Color: =RGBA(39, 116, 174,1)
            FontWeight: =FontWeight.Bold
            Height: =73
            Size: =18
            Text: |-
                ="Family Survey:"
            Visible: =flgAttendance
            Width: =195
            X: =49
            Y: =lblRHPatientLabel.Y+lblRHPatientLabel.Height+40
            ZIndex: =22

        lblRHPatient As label:
            BorderThickness: =1
            Color: =RGBA(39, 116, 174,1)
            Height: =73
            PaddingLeft: =15
            PaddingRight: =15
            Size: =18
            Text: |-
                =CountRows(
                    Filter(
                        RenameColumns(
                            Filter(
                                Filter(
                                    Filter(
                                        colSurvList,
                                        Lower(CreatedBy) = Lower(User().Email)
                                    ),
                                    SurveyType = "Patient"
                                ),
                                And(
                                    Created >= dpRHCompStart.SelectedDate,
                                    Created <= dpRHCompEnd
                                )
                            ),
                            "Created",
                            "SurvCreated"
                        ),
                        LookUp(
                            Rounds_Calendar,
                            DateDiff('Start Time', SurvCreated, TimeUnit.Days)=0,
                            true
                        )
                    )
                )
                /*CountRows(
                    Filter(
                        Filter(
                            Filter(
                                colSurvList,
                                Lower(CreatedBy)=Lower(User().Email)
                            ),
                            SurveyType = "Patient"
                        ),
                        And(
                            Created >= dateRHStart.SelectedDate,
                            Created <= dateRHEnd
                        )
                    )
                )*/
            Visible: =flgAttendance
            Width: =325
            X: =269
            Y: =lblRHStaffLabel.Y+lblRHStaffLabel.Height+40
            ZIndex: =23

        lblRHPatientLabel As label:
            Align: =Align.Right
            Color: =RGBA(39, 116, 174,1)
            FontWeight: =FontWeight.Bold
            Height: =73
            Size: =18
            Text: |-
                ="Patient Survey:"
            Visible: =flgAttendance
            Width: =195
            X: =49
            Y: =lblRHStaffLabel.Y+lblRHStaffLabel.Height+40
            ZIndex: =24

        lblRHStaff As label:
            BorderThickness: =1
            Color: =RGBA(39, 116, 174,1)
            Height: =73
            PaddingLeft: =15
            PaddingRight: =15
            Size: =18
            Text: |-
                =CountRows(
                    Filter(
                        RenameColumns(
                            Filter(
                                Filter(
                                    Filter(
                                        colSurvList,
                                        Lower(CreatedBy) = Lower(User().Email)
                                    ),
                                    SurveyType = "Staff"
                                ),
                                And(
                                    Created >= dpRHCompStart.SelectedDate,
                                    Created <= dpRHCompEnd
                                )
                            ),
                            "Created",
                            "SurvCreated"
                        ),
                        LookUp(
                            Rounds_Calendar,
                            DateDiff('Start Time', SurvCreated, TimeUnit.Days)=0,
                            true
                        )
                    )
                )
                /*
                CountRows(
                    Filter(
                        RenameColumns(
                            Filter(
                                Filter(
                                    Filter(
                                        colSurvList,
                                        Lower(CreatedBy) = Lower(User().Email)
                                    ),
                                    SurveyType = "Staff"
                                ),
                                And(
                                    Created >= dateRHStart.SelectedDate,
                                    Created <= dateRHEnd
                                )
                            ),
                            "Title",
                            "SurvTitle"
                        ),
                        LookUp(
                            Rounds_Calendar,
                            Title = SurvTitle,
                            true
                        )
                    )
                )
                
                CountRows(
                    Filter(
                        Filter(
                            Filter(
                                Filter(
                                    colSurvList,
                                    IsAdHoc = false
                                ),
                                Lower(CreatedBy) = Lower(User().Email)
                            ),
                            SurveyType = "Staff"
                        ),
                        And(
                            Created >= dateRHStart.SelectedDate,
                            Created <= dateRHEnd
                        )
                    )
                )*/
            Visible: =flgAttendance
            Width: =325
            X: =269
            Y: =lblRHAttTitle.Y+lblRHAttTitle.Height + 50
            ZIndex: =25

        lblRHStaffLabel As label:
            Align: =Align.Right
            Color: =RGBA(39, 116, 174,1)
            FontWeight: =FontWeight.Bold
            Height: =73
            Size: =18
            Text: |-
                ="Staff Survey:"
            Visible: =flgAttendance
            Width: =195
            X: =49
            Y: =lblRHAttTitle.Y+lblRHAttTitle.Height+50
            ZIndex: =27

        lblRHAttTitle As label:
            Align: =Align.Center
            Color: =RGBA(255, 245, 121, 1)
            Fill: =RGBA(39, 116, 174,1)
            FontWeight: =FontWeight.Bold
            Height: =73
            Size: =21
            Text: ="Total of CICARE Rounds attended "
            Visible: =flgAttendance
            Width: =580
            X: =34
            Y: =rectRHCompSurvDate.Y+rectRHCompSurvDate.Height
            ZIndex: =29

